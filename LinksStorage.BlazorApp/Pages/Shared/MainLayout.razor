@inherits LayoutComponentBase
@inject AuthService authService

<PageTitle>@Env.Get("APP_NAME")</PageTitle>

<MudThemeProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<CascadingValue Value="this">
	<MudLayout>
		<NavMenu/>
		<MudMainContent>
			@Body
		</MudMainContent>
	</MudLayout>
</CascadingValue>

@code {
    [CascadingParameter]
    public Task<AuthenticationState> AuthenticationStateTask { get; set; }
    public User? User = new User();

    protected override async Task OnInitializedAsync()
    {
        var authState = await AuthenticationStateTask;

        if (authState.User.Identity.IsAuthenticated)
        {
            User = await authService.GetAuthenticatedUser();
        }
    }
}